---
import { Image } from "astro:assets";
import type { ImageAsset } from "../../provider/imageProvider";
import { getImageAlt } from "../../provider/imageProvider";
import { getLangFromUrl } from "../../i18n/utils";

const lang = getLangFromUrl(Astro.url);

interface NavigationCard {
  /**
   * Relative URL for the destination page of the card.
   */
  href: string;
  /**
   * Image with src and alt from central registry.
   */
  image: ImageAsset;
  /**
   * Supporting description shown under the card title.
   */
  text: string;
  /**
   * Main heading displayed on the card.
   */
  title: string;
}

interface Props {
  /**
   * Three cards rendered in the navigation grid.
   */
  cards: [NavigationCard, NavigationCard, NavigationCard];
  /**
   * Text for the "more details" link on each card.
   */
  moreDetailsText?: string;
  /**
   * Introductory badge text above the section heading.
   */
  sectionBadge: string;
  /**
   * Supporting paragraph under the section heading.
   */
  sectionDescription: string;
  /**
   * Main section heading for the navigation block.
   */
  sectionTitle: string;
}

const {
  cards,
  moreDetailsText = "weitere details â†’",
  sectionBadge,
  sectionDescription,
  sectionTitle,
} = Astro.props;
---

{/* ImageNavigation: Service navigation with image cards */}
<section class="bg-slate-100">
  <div class="mx-auto max-w-8xl px-6 py-12 md:px-12 md:py-20 lg:px-16 lg:py-24">
    {/* Section header: badge, title, description */}
    <div class="fade-in-section mb-6 max-w-4xl md:mb-8">
      <div
        class="mb-4 inline-block rounded-tl-xl rounded-br-xl bg-gradient-to-r from-primary to-primary-light px-3 py-1 md:mb-6"
      >
        <h3
          class="font-outfit text-sm uppercase tracking-wider text-white leading-[1.3] md:text-base"
        >
          {sectionBadge}
        </h3>
      </div>

      {/* Title: main section heading */}
      <h2
        class="mb-1 font-anton text-3xl leading-tight text-dark md:text-4xl lg:text-5xl"
      >
        {sectionTitle}
      </h2>

      {/* Description: supporting paragraph */}
      <p class="text-base font-light leading-relaxed text-dark/70 md:text-lg">
        {sectionDescription}
      </p>
    </div>

    {/* Navigation cards grid */}
    <div
      class="fade-in-section delay-200 grid grid-cols-1 gap-4 md:h-[42rem] md:grid-cols-2 md:gap-6"
    >
      {
        cards.map((card, index) => {
          const isFeatured = index === 0;

          return (
            <a
              href={card.href}
              class:list={[
                "group relative h-64 overflow-hidden rounded-br-4xl md:h-auto md:min-h-0",
                isFeatured && "md:row-span-2",
              ]}
            >
              {/* Card image: full-bleed background */}
              <Image
                src={card.image.src as import("astro").ImageMetadata}
                alt={getImageAlt(card.image, lang)}
                class="h-full w-full object-cover transition-transform duration-700 group-hover:scale-105"
                width={768}
                height={630}
              />
              {/* Image overlays: dark tint + bottom gradient for text */}
              <div class="absolute inset-0 bg-black/25" />
              <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent" />

              {/* Card content: title, description, "more details" link */}
              <div
                class:list={[
                  "absolute bottom-0 left-0 right-0",
                  isFeatured ? "p-6 md:p-12" : "p-4 md:p-10",
                ]}
              >
                <div class={isFeatured ? "mb-4 md:mb-6" : "mb-2 md:mb-4"}>
                  <h3
                    class:list={[
                      "font-anton text-white leading-tight",
                      isFeatured
                        ? "mb-2 text-3xl md:mb-3 md:text-5xl"
                        : "mb-1 text-2xl md:mb-2 md:text-4xl",
                    ]}
                  >
                    {card.title}
                  </h3>
                  <p
                    class:list={[
                      "text-white/90 leading-relaxed",
                      isFeatured
                        ? "text-sm md:text-lg"
                        : "text-sm md:text-base",
                    ]}
                  >
                    {card.text}
                  </p>
                </div>
                <span
                  class:list={[
                    "inline-flex items-center border-b-2 border-white/50 pb-1 text-white font-medium uppercase tracking-wider transition-all duration-300 group-hover:border-white",
                    isFeatured ? "text-sm md:text-base" : "text-xs md:text-sm",
                  ]}
                >
                  {moreDetailsText}
                </span>
              </div>
            </a>
          );
        })
      }
    </div>
  </div>
</section>
