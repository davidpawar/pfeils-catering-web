---
/**
 * Single testimonial entry.
 */
interface TestimonialItem {
  /** Job title or role of the person (e.g. "Geschäftsführer"). */
  jobTitle: string;
  /** Full name of the person. */
  name: string;
  /** The testimonial quote text. */
  text: string;
}

interface Props {
  /** Optional badge text above the section title. */
  badge?: string;
  /** Optional description paragraph under the section title. */
  description?: string;
  /** List of testimonial items to display. */
  testimonials: TestimonialItem[];
  /** Section heading. */
  title: string;
  /** Color theme: light (white) or dark background. */
  theme?: "light" | "dark";
}

const {
  badge,
  description,
  testimonials,
  title,
  theme = "light",
} = Astro.props;
const isDark = theme === "dark";
const hasTestimonials = testimonials.length > 0;

const titleClass = isDark ? "text-white" : "text-dark";
const descClass = isDark ? "text-white/80" : "text-dark/70";
const cardBgClass = isDark ? "bg-white/5" : "bg-slate-100";
const cardTextClass = isDark ? "text-white/90" : "text-dark/80";
const nameClass = isDark ? "text-white" : "text-dark";
const jobClass = isDark ? "text-primary-light" : "text-primary";
const quoteClass = isDark ? "text-primary-light/60" : "text-primary/60";
---

{/* Testimonials Section */}
{
  hasTestimonials && (
    <section
      class:list={[
        "relative overflow-hidden",
        isDark ? "bg-dark-bg" : "bg-white",
      ]}
    >
      <div class="mx-auto max-w-7xl px-6 py-12 md:px-12 md:py-20 lg:px-16 lg:py-24">
        {/* Section header: badge, title, description */}
        {(badge || title || description) && (
          <div class="fade-in-section mb-8 max-w-4xl md:mb-12">
            {badge && (
              <div class="mb-4 inline-block rounded-tl-xl rounded-br-xl bg-gradient-to-r from-primary to-primary-light px-3 py-1 md:mb-6">
                <h3 class="font-outfit text-sm uppercase tracking-wider text-white leading-[1.3] md:text-base">
                  {badge}
                </h3>
              </div>
            )}
            {title && (
              <h2
                class:list={[
                  "font-anton text-3xl leading-tight md:text-4xl lg:text-5xl",
                  titleClass,
                ]}
              >
                {title}
              </h2>
            )}
            {description && (
              <p
                class:list={[
                  "mt-1 text-base font-light leading-relaxed md:text-lg",
                  descClass,
                ]}
              >
                {description}
              </p>
            )}
          </div>
        )}

        {/* Testimonial cards grid */}
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
          {testimonials.map((item, i) => (
            <article
              class:list={[
                "fade-in-section flex flex-col rounded-br-4xl p-6 transition-shadow hover:shadow-lg md:p-8",
                cardBgClass,
                i === 1 && "delay-200",
                i === 2 && "delay-200",
              ]}
            >
              {/* Quote icon */}
              <div class:list={["mb-4 h-10 w-10 shrink-0", quoteClass]}>
                <svg
                  aria-hidden="true"
                  viewBox="0 0 512 512"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="currentColor"
                  class="h-full w-full"
                >
                  <path d="M464 32H336c-26.5 0-48 21.5-48 48v128c0 26.5 21.5 48 48 48h80v64c0 35.3-28.7 64-64 64h-8c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h8c88.4 0 160-71.6 160-160V80c0-26.5-21.5-48-48-48zm-288 0H48C21.5 32 0 53.5 0 80v128c0 26.5 21.5 48 48 48h80v64c0 35.3-28.7 64-64 64h-8c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h8c88.4 0 160-71.6 160-160V80c0-26.5-21.5-48-48-48z" />
                </svg>
              </div>

              {/* Quote text */}
              <p
                class:list={[
                  "mb-6 flex-1 font-outfit text-base leading-relaxed md:text-lg",
                  cardTextClass,
                ]}
              >
                {item.text}
              </p>

              {/* Author */}
              <footer>
                <p
                  class:list={["font-outfit text-lg font-semibold", nameClass]}
                >
                  {item.name}
                </p>
                <p class:list={["font-outfit text-sm", jobClass]}>
                  {item.jobTitle}
                </p>
              </footer>
            </article>
          ))}
        </div>
      </div>
    </section>
  )
}
