---
import { Image } from "astro:assets";
import type { ImageAsset } from "../../provider/imageProvider";
import { getImageAlt } from "../../provider/imageProvider";
import { getLangFromUrl } from "../../i18n/utils";

const lang = getLangFromUrl(Astro.url);

/**
 * Single reference/partner item in the logo list.
 */
interface LogoItem {
  /** Short one-sentence description. */
  description: string;
  /** External URL the card links to. */
  href: string;
  /** Logo image from image provider (PNG/SVG). */
  image: ImageAsset;
  /** Company or partner name. */
  title: string;
}

/**
 * LogoList component props.
 */
interface Props {
  /** Optional badge text above the section title (e.g. "Referenzen"). */
  badge?: string;
  /** Optional description paragraph under the section title. */
  description?: string;
  /** List of partner/reference items to display. */
  logos: LogoItem[];
  /** Optional section heading. */
  title?: string;
  /** Color theme: light (white) or dark background. */
  theme?: "light" | "dark";
}

const { badge, description, logos, title, theme = "light" } = Astro.props;
const isDark = theme === "dark";
const hasLogos = logos.length > 0;
---

{/* LogoList: Reference/partner section with cards */}
{
  hasLogos && (
    <section
      class:list={[
        "relative overflow-hidden",
        isDark ? "bg-dark-bg" : "bg-white",
      ]}
    >
      <div class="mx-auto max-w-7xl px-6 py-12 md:px-12 md:py-20 lg:px-16 lg:py-24">
        {/* Section header: badge, title, description */}
        {(badge || title || description) && (
          <div class="fade-in-section mb-6 max-w-4xl md:mb-8">
            {badge && (
              <div class="mb-4 inline-block rounded-tl-xl rounded-br-xl bg-gradient-to-r from-primary to-primary-light px-3 py-1 md:mb-6">
                <h3 class="font-outfit text-sm uppercase tracking-wider text-white leading-[1.3] md:text-base">
                  {badge}
                </h3>
              </div>
            )}
            {title && (
              <h2
                class:list={[
                  "font-anton text-3xl leading-tight md:text-4xl lg:text-5xl",
                  isDark ? "text-white" : "text-dark",
                ]}
              >
                {title}
              </h2>
            )}
            {description && (
              <p
                class:list={[
                  "mt-1 text-base font-light leading-relaxed md:text-lg",
                  isDark ? "text-white/80" : "text-dark/70",
                ]}
              >
                {description}
              </p>
            )}
          </div>
        )}

        {/* Partner/reference cards grid */}
        <div class="fade-in-section delay-200 grid grid-cols-1 gap-4 sm:grid-cols-2 md:gap-6 lg:grid-cols-3">
          {logos.map((item) => (
            <a
              href={item.href}
              target="_blank"
              rel="noopener noreferrer"
              class:list={[
                "group flex flex-col rounded-br-4xl overflow-hidden p-6 transition-all duration-300 hover:-translate-y-0.5",
                isDark
                  ? "bg-white/5 hover:bg-white/10"
                  : "bg-slate-100 hover:bg-slate-200",
              ]}
            >
              {/* Logo */}
              <div class="mb-4 flex h-16 items-center md:h-20">
                <Image
                  src={item.image.src as import("astro").ImageMetadata}
                  alt={getImageAlt(item.image, lang)}
                  class="h-full w-auto max-w-32 object-contain object-left opacity-90 transition-opacity duration-300 group-hover:opacity-100"
                  width={160}
                  height={80}
                />
              </div>
              {/* Title */}
              <h3
                class:list={[
                  "mb-2 font-anton text-xl leading-tight md:text-2xl",
                  isDark ? "text-white" : "text-dark",
                ]}
              >
                {item.title}
              </h3>
              {/* Description */}
              <p
                class:list={[
                  "flex-1 text-sm leading-relaxed md:text-base",
                  isDark ? "text-white/80" : "text-dark/70",
                ]}
              >
                {item.description}
              </p>
            </a>
          ))}
        </div>
      </div>
    </section>
  )
}
